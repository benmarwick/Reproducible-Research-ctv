language: c
language: r

os:
  - linux
  - osx
  
sudo: required

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update          ; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install pandoc  ; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get -y update  ; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then wget `curl https://api.github.com/repos/jgm/pandoc/releases/latest | jq -r '.assets[] | .browser_download_url | select(endswith("deb"))'` -O pandoc.deb && sudo dpkg -i pandoc.deb && rm pandoc.deb
 ; fi

script: make

deploy:
  provider: releases
  api_key: "${GITHUB_OAUTH_TOKEN}"
  file: "README.md"
  skip_cleanup: true
  on:
    tags: true
